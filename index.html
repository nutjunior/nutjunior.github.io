<form id="subscribe-form">
  <h1>Subscribe to our mailing list</h1>
  <input type="email" name="email" placeholder="you@example.com" required>
  <button type="submit">Subscribe</button>
  <p id="subscribe-success" style="display:none; color:green;">
    Thanks! Youâ€™re on the list.
  </p>
  <p id="subscribe-error" style="display:none; color:red;">
    Error submitting. Please try again.
  </p>
</form>

<script>
const form = document.getElementById("subscribe-form");
const successMsg = document.getElementById("subscribe-success");
const errorMsg = document.getElementById("subscribe-error");

// Replace with your deployed Web App URL
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbzeaLrqIc2ZQaqE5xgGfZfFK7EIgT61FdZqIobLEKwbBbzLTMkuM18Qt8GH7nBOLIVZ/exec";

form.addEventListener("submit", async (e) => {
  e.preventDefault();
  successMsg.style.display = "none";
  errorMsg.style.display = "none";

  const email = form.email.value.trim();

  try {
    const res = await fetch(WEB_APP_URL, {
      method: "POST",
      headers: {"Content-Type": "application/json"},
      body: JSON.stringify({email: email, action: "subscribe"})
    });

    if (res.ok) {
      successMsg.style.display = "block";
      form.reset();
    } else {
      errorMsg.style.display = "block";
    }
  } catch (err) {
    console.error(err);
    errorMsg.style.display = "block";
  }
});
</script>
